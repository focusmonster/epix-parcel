import   "f5e4645350a6dde55620dd3832268665:@babel/runtime/helpers/esm/objectWithoutProperties";
import   "f5e4645350a6dde55620dd3832268665:@babel/runtime/helpers/esm/extends";
import   "f5e4645350a6dde55620dd3832268665:react";
import   "f5e4645350a6dde55620dd3832268665:jss";
import   "f5e4645350a6dde55620dd3832268665:../mergeClasses";
import   "f5e4645350a6dde55620dd3832268665:./multiKeyStore";
import   "f5e4645350a6dde55620dd3832268665:../useTheme";
import   "f5e4645350a6dde55620dd3832268665:../StylesProvider";
import   "f5e4645350a6dde55620dd3832268665:./indexCounter";
import   "f5e4645350a6dde55620dd3832268665:../getStylesCreator";
import   "f5e4645350a6dde55620dd3832268665:../getStylesCreator/noopTheme";
function $f5e4645350a6dde55620dd3832268665$var$getClasses(_ref, classes, Component) {
    var state = _ref.state, stylesOptions = _ref.stylesOptions;
    if (stylesOptions.disableGeneration) return classes || {
    };
    if (!state.cacheClasses) state.cacheClasses = {
        // Cache for the finalized classes value.
        value: null,
        // Cache for the last used classes prop pointer.
        lastProp: null,
        // Cache for the last used rendered classes pointer.
        lastJSS: {
        }
    };
     // Tracks if either the rendered classes or classes prop has changed,
    // requiring the generation of a new finalized classes object.
    var generate = false;
    if (state.classes !== state.cacheClasses.lastJSS) {
        state.cacheClasses.lastJSS = state.classes;
        generate = true;
    }
    if (classes !== state.cacheClasses.lastProp) {
        state.cacheClasses.lastProp = classes;
        generate = true;
    }
    if (generate) state.cacheClasses.value = $f5e4645350a6dde55620dd3832268665$import$883780b9d1e1a9ee$9099ad97b570f7c({
        baseClasses: state.cacheClasses.lastJSS,
        newClasses: classes,
        Component: Component
    });
    return state.cacheClasses.value;
}
function $f5e4645350a6dde55620dd3832268665$var$attach(_ref2, props) {
    var state = _ref2.state, theme = _ref2.theme, stylesOptions = _ref2.stylesOptions, stylesCreator = _ref2.stylesCreator, name = _ref2.name;
    if (stylesOptions.disableGeneration) return;
    var sheetManager = $f5e4645350a6dde55620dd3832268665$import$a3fb3865b941fc11$9099ad97b570f7c.get(stylesOptions.sheetsManager, stylesCreator, theme);
    if (!sheetManager) {
        sheetManager = {
            refs: 0,
            staticSheet: null,
            dynamicStyles: null
        };
        $f5e4645350a6dde55620dd3832268665$import$a3fb3865b941fc11$9099ad97b570f7c.set(stylesOptions.sheetsManager, stylesCreator, theme, sheetManager);
    }
    var options = $f5e4645350a6dde55620dd3832268665$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
    }, stylesCreator.options, stylesOptions, {
        theme: theme,
        flip: typeof stylesOptions.flip === 'boolean' ? stylesOptions.flip : theme.direction === 'rtl'
    });
    options.generateId = options.serverGenerateClassName || options.generateClassName;
    var sheetsRegistry = stylesOptions.sheetsRegistry;
    if (sheetManager.refs === 0) {
        var staticSheet;
        if (stylesOptions.sheetsCache) staticSheet = $f5e4645350a6dde55620dd3832268665$import$a3fb3865b941fc11$9099ad97b570f7c.get(stylesOptions.sheetsCache, stylesCreator, theme);
        var styles = stylesCreator.create(theme, name);
        if (!staticSheet) {
            staticSheet = stylesOptions.jss.createStyleSheet(styles, $f5e4645350a6dde55620dd3832268665$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
                link: false
            }, options));
            staticSheet.attach();
            if (stylesOptions.sheetsCache) $f5e4645350a6dde55620dd3832268665$import$a3fb3865b941fc11$9099ad97b570f7c.set(stylesOptions.sheetsCache, stylesCreator, theme, staticSheet);
        }
        if (sheetsRegistry) sheetsRegistry.add(staticSheet);
        sheetManager.staticSheet = staticSheet;
        sheetManager.dynamicStyles = $f5e4645350a6dde55620dd3832268665$import$d20617c95de8a6c6$1fef22c85b1157e(styles);
    }
    if (sheetManager.dynamicStyles) {
        var dynamicSheet = stylesOptions.jss.createStyleSheet(sheetManager.dynamicStyles, $f5e4645350a6dde55620dd3832268665$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
            link: true
        }, options));
        dynamicSheet.update(props);
        dynamicSheet.attach();
        state.dynamicSheet = dynamicSheet;
        state.classes = $f5e4645350a6dde55620dd3832268665$import$883780b9d1e1a9ee$9099ad97b570f7c({
            baseClasses: sheetManager.staticSheet.classes,
            newClasses: dynamicSheet.classes
        });
        if (sheetsRegistry) sheetsRegistry.add(dynamicSheet);
    } else state.classes = sheetManager.staticSheet.classes;
    sheetManager.refs += 1;
}
function $f5e4645350a6dde55620dd3832268665$var$update(_ref3, props) {
    var state = _ref3.state;
    if (state.dynamicSheet) state.dynamicSheet.update(props);
}
function $f5e4645350a6dde55620dd3832268665$var$detach(_ref4) {
    var state = _ref4.state, theme = _ref4.theme, stylesOptions = _ref4.stylesOptions, stylesCreator = _ref4.stylesCreator;
    if (stylesOptions.disableGeneration) return;
    var sheetManager = $f5e4645350a6dde55620dd3832268665$import$a3fb3865b941fc11$9099ad97b570f7c.get(stylesOptions.sheetsManager, stylesCreator, theme);
    sheetManager.refs -= 1;
    var sheetsRegistry = stylesOptions.sheetsRegistry;
    if (sheetManager.refs === 0) {
        $f5e4645350a6dde55620dd3832268665$import$a3fb3865b941fc11$9099ad97b570f7c.delete(stylesOptions.sheetsManager, stylesCreator, theme);
        stylesOptions.jss.removeStyleSheet(sheetManager.staticSheet);
        if (sheetsRegistry) sheetsRegistry.remove(sheetManager.staticSheet);
    }
    if (state.dynamicSheet) {
        stylesOptions.jss.removeStyleSheet(state.dynamicSheet);
        if (sheetsRegistry) sheetsRegistry.remove(state.dynamicSheet);
    }
}
function $f5e4645350a6dde55620dd3832268665$var$useSynchronousEffect(func, values) {
    var key = $f5e4645350a6dde55620dd3832268665$import$f02ba03fc070e88c$9099ad97b570f7c.useRef([]);
    var output; // Store "generation" key. Just returns a new object every time
    var currentKey = $f5e4645350a6dde55620dd3832268665$import$f02ba03fc070e88c$9099ad97b570f7c.useMemo(function() {
        return {
        };
    }, values); // eslint-disable-line react-hooks/exhaustive-deps
    // "the first render", or "memo dropped the value"
    if (key.current !== currentKey) {
        key.current = currentKey;
        output = func();
    }
    $f5e4645350a6dde55620dd3832268665$import$f02ba03fc070e88c$9099ad97b570f7c.useEffect(function() {
        return function() {
            if (output) output();
        };
    }, [
        currentKey
    ]// eslint-disable-line react-hooks/exhaustive-deps
    );
}
function $f5e4645350a6dde55620dd3832268665$export$9099ad97b570f7c(stylesOrCreator) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    };
    var name = options.name, classNamePrefixOption = options.classNamePrefix, Component = options.Component, _options$defaultTheme = options.defaultTheme, defaultTheme = _options$defaultTheme === void 0 ? $f5e4645350a6dde55620dd3832268665$import$91650a0ce6b8799d$9099ad97b570f7c : _options$defaultTheme, stylesOptions2 = $f5e4645350a6dde55620dd3832268665$import$e114c77af6cc4d77$9099ad97b570f7c(options, [
        "name",
        "classNamePrefix",
        "Component",
        "defaultTheme"
    ]);
    var stylesCreator = $f5e4645350a6dde55620dd3832268665$import$949608bda57b50de$9099ad97b570f7c(stylesOrCreator);
    var classNamePrefix = name || classNamePrefixOption || 'makeStyles';
    stylesCreator.options = {
        index: $f5e4645350a6dde55620dd3832268665$import$4a2aef3d972ad4c3$2921b019f20402e5(),
        name: name,
        meta: classNamePrefix,
        classNamePrefix: classNamePrefix
    };
    var useStyles = function useStyles1() {
        var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
        };
        var theme = $f5e4645350a6dde55620dd3832268665$import$cd58002ab20c36b6$9099ad97b570f7c() || defaultTheme;
        var stylesOptions = $f5e4645350a6dde55620dd3832268665$import$b5eba6ed2ba96e9b$9099ad97b570f7c({
        }, $f5e4645350a6dde55620dd3832268665$import$f02ba03fc070e88c$9099ad97b570f7c.useContext($f5e4645350a6dde55620dd3832268665$import$e369d104f66fd558$9c7e69fa1b5fcac6), stylesOptions2);
        var instance = $f5e4645350a6dde55620dd3832268665$import$f02ba03fc070e88c$9099ad97b570f7c.useRef();
        var shouldUpdate = $f5e4645350a6dde55620dd3832268665$import$f02ba03fc070e88c$9099ad97b570f7c.useRef();
        $f5e4645350a6dde55620dd3832268665$var$useSynchronousEffect(function() {
            var current = {
                name: name,
                state: {
                },
                stylesCreator: stylesCreator,
                stylesOptions: stylesOptions,
                theme: theme
            };
            $f5e4645350a6dde55620dd3832268665$var$attach(current, props);
            shouldUpdate.current = false;
            instance.current = current;
            return function() {
                $f5e4645350a6dde55620dd3832268665$var$detach(current);
            };
        }, [
            theme,
            stylesCreator
        ]);
        $f5e4645350a6dde55620dd3832268665$import$f02ba03fc070e88c$9099ad97b570f7c.useEffect(function() {
            if (shouldUpdate.current) $f5e4645350a6dde55620dd3832268665$var$update(instance.current, props);
            shouldUpdate.current = true;
        });
        var classes = $f5e4645350a6dde55620dd3832268665$var$getClasses(instance.current, props.classes, Component);
        return classes;
    };
    return useStyles;
}
